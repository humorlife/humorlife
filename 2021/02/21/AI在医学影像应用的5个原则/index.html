<!DOCTYPE html>


<html lang="zh-CN">


<head>
  <meta charset="utf-8" />
   
  <meta name="keywords" content="重症 医学" />
   
  <meta name="description" content="北戴河医院重症医学科的网络的交流园地" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    AI在医学影像应用的5个原则 |  海滨重症
  </title>
  <meta name="generator" content="hexo-theme-ayer">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css">
  
<link rel="stylesheet" href="/css/custom.css">

  
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
  
  

  

<link rel="alternate" href="/atom.xml" title="海滨重症" type="application/atom+xml">
</head>

</html>

<body>
  <div id="app">
    
      <canvas class="fireworks"></canvas>
      <style>
        .fireworks {
          position: fixed;
          left: 0;
          top: 0;
          z-index: 99999;
          pointer-events: none;
        }
      </style>
      
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-AI在医学影像应用的5个原则"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  AI在医学影像应用的5个原则
</h1>
 

    </header>
     
    <div class="article-meta">
      <a href="/2021/02/21/AI%E5%9C%A8%E5%8C%BB%E5%AD%A6%E5%BD%B1%E5%83%8F%E5%BA%94%E7%94%A8%E7%9A%845%E4%B8%AA%E5%8E%9F%E5%88%99/" class="article-date">
  <time datetime="2021-02-21T11:34:50.000Z" itemprop="datePublished">2021-02-21</time>
</a>   
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> 字数统计:</span>
            <span class="post-count">1.3k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> 阅读时长≈</span>
            <span class="post-count">7 分钟</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="Five-principles-for-the-intelligent-use-of-AI-in-medical-imaging"><a href="#Five-principles-for-the-intelligent-use-of-AI-in-medical-imaging" class="headerlink" title="Five principles for the intelligent use of AI in medical imaging"></a>Five principles for the intelligent use of AI in medical imaging</h1><ul>
<li><a href="javascript:;">Errol Colak</a>             <a target="_blank" rel="noopener" href="http://61.175.198.136:8083/rwt/150/http/N73GG4LEF3YYE3D/0000-0002-3771-7975">ORCID: orcid.org/0000-0002-3771-7975</a><a target="_blank" rel="noopener" href="http://61.175.198.136:8083/rwt/150/https/NSVX643PPNZHE4LPM7TYELUDN7XB/article/10.1007/s00134-020-06316-8#Aff1">1</a>,<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/rwt/150/https/NSVX643PPNZHE4LPM7TYELUDN7XB/article/10.1007/s00134-020-06316-8#Aff2">2</a>, </li>
<li><a href="javascript:;">Robert Moreland</a>             <a target="_blank" rel="noopener" href="http://61.175.198.136:8083/rwt/150/http/N73GG4LEF3YYE3D/0000-0001-5456-1637">ORCID: orcid.org/0000-0001-5456-1637</a><a target="_blank" rel="noopener" href="http://61.175.198.136:8083/rwt/150/https/NSVX643PPNZHE4LPM7TYELUDN7XB/article/10.1007/s00134-020-06316-8#Aff3">3</a>,<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/rwt/150/https/NSVX643PPNZHE4LPM7TYELUDN7XB/article/10.1007/s00134-020-06316-8#Aff4">4</a> &amp; </li>
<li><a href="javascript:;">Marzyeh Ghassemi</a>             <a target="_blank" rel="noopener" href="http://61.175.198.136:8083/rwt/150/http/N73GG4LEF3YYE3D/0000-0001-6349-7251">ORCID: orcid.org/0000-0001-6349-7251</a><a target="_blank" rel="noopener" href="http://61.175.198.136:8083/rwt/150/https/NSVX643PPNZHE4LPM7TYELUDN7XB/article/10.1007/s00134-020-06316-8#Aff5">5</a>,<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/rwt/150/https/NSVX643PPNZHE4LPM7TYELUDN7XB/article/10.1007/s00134-020-06316-8#Aff6">6</a> </li>
</ul>
<p><a target="_blank" rel="noopener" href="http://61.175.198.136:8083/journal/134"><em>Intensive Care Medicine</em></a>                             <strong>volume 47</strong>, pages154–156(2021)<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/rwt/150/https/NSVX643PPNZHE4LPM7TYELUDN7XB/article/10.1007/s00134-020-06316-8#citeas">Cite this article</a>                         </p>
<ul>
<li>1901 Accesses</li>
<li>21 Altmetric</li>
<li><a target="_blank" rel="noopener" href="http://61.175.198.136:8083/article/10.1007/s00134-020-06316-8/metrics">Metrics details</a></li>
</ul>
<h2 id="Clinical-scenario"><a href="#Clinical-scenario" class="headerlink" title="Clinical scenario"></a>Clinical scenario</h2><p>You are a critical care physician at a medium-sized urban hospital. A local start-up is promoting software that claims to automatically interpret chest X-rays. Having read many articles about artificial intelligence, you are intrigued by the idea of using it. However, you have never had to decide if, when, and how to deploy these technologies in clinical practice.</p>
<h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><p>Artificial intelligence (AI) promises to transform healthcare by improving clinical decision-making, reducing errors, and automating tasks [<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/article/10.1007/s00134-020-06316-8#ref-CR1">1</a>]. Recent advances in machine learning (ML), a branch of AI, have demonstrated expert-level task performance including medical image analysis [<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/article/10.1007/s00134-020-06316-8#ref-CR2">2</a>]. With an increasing number of medical imaging ML systems receiving regulatory approval, critical care physicians will have an additional set of tools at their disposal. However, the deployment of these systems into clinical environments can be fraught with pitfalls. This article introduces 5 key principles that should be remembered as the adoption of ML systems becomes more widespread.</p>
<h3 id="Knowledge-base-ensure-you-have-enough-understanding-of-machine-learning-to-separate-fact-from-fiction-in-vendor-claims"><a href="#Knowledge-base-ensure-you-have-enough-understanding-of-machine-learning-to-separate-fact-from-fiction-in-vendor-claims" class="headerlink" title="Knowledge base: ensure you have enough understanding of machine learning to separate fact from fiction in vendor claims"></a>Knowledge base: ensure you have enough understanding of machine learning to separate fact from fiction in vendor claims</h3><p>If physicians are to be integral to the development, adoption, and oversight of ML models, it is paramount for them to develop basic competency in ML. Physicians should become familiar with dataset preparation, model architecture selection, and how statistical methods are applied during model evaluation. Knowledge and skills in ML would empower physicians to understand the potential capabilities and limitations of ML, critically appraise and validate models, and address patient concerns. A deeper understanding of how ML models are created and evaluated may help to determine how model outputs can be best integrated into clinical decision-making. Readers are encouraged to explore the many online educational resources, many free of charge, that are available for self-directed and class-based learning (Supplemental Material).</p>
<h3 id="Metrics-ensure-that-the-evaluation-metrics-provided-by-the-vendor-are-meaningful-in-clinical-practice-and-not-limited-to-accuracy"><a href="#Metrics-ensure-that-the-evaluation-metrics-provided-by-the-vendor-are-meaningful-in-clinical-practice-and-not-limited-to-accuracy" class="headerlink" title="Metrics: ensure that the evaluation metrics provided by the vendor are meaningful in clinical practice and not limited to accuracy"></a>Metrics: ensure that the evaluation metrics provided by the vendor are meaningful in clinical practice and not limited to accuracy</h3><p>Model performance is often reported as an accuracy measure or confusion matrix. This is potentially problematic as models may demonstrate reduced accuracy when operating under real-world circumstances [<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/article/10.1007/s00134-020-06316-8#ref-CR3">3</a>]. Furthermore, these metrics fail to consider prevalence, the impact of incorrect recommendations, and may in fact convey a false sense of safety. Determining a model’s clinical benefit, robustness, direct and indirect costs, calibration, safety profile, interpretability, and user acceptance are much more meaningful forms of evaluation and are unfortunately often not available [<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/article/10.1007/s00134-020-06316-8#ref-CR4">4</a>]. Rather than focusing on the area under the curve, a commonly used metric in the ML literature, the focus needs to be on rigorous clinical validation. The validation process for a novel ML model should be no less rigorous and thorough than that of a new drug or diagnostic test to ensure efficacy, reliability, acceptability, and safety [<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/article/10.1007/s00134-020-06316-8#ref-CR5">5</a>].</p>
<h3 id="Bias-ensure-the-data-used-for-model-development-by-the-vendor-reflects-the-case-mix-of-your-ICU-and-that-the-model-has-been-validated-using-external-datasets"><a href="#Bias-ensure-the-data-used-for-model-development-by-the-vendor-reflects-the-case-mix-of-your-ICU-and-that-the-model-has-been-validated-using-external-datasets" class="headerlink" title="Bias: ensure the data used for model development by the vendor reflects the case mix of your ICU and that the model has been validated using external datasets."></a>Bias: ensure the data used for model development by the vendor reflects the case mix of your ICU and that the model has been validated using external datasets.</h3><p>At their heart ML models are pattern recognition systems and can perform poorly outside the scope of the data used to train them [<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/article/10.1007/s00134-020-06316-8#ref-CR6">6</a>]. They are highly dependent on the characteristics of this training data and vulnerable to any underlying selection biases. Specific patient populations and types of pathology may be under-represented during training but commonly encountered in your practice. Selection bias can reflect the patient population (e.g., age, gender, race), range of pathology (e.g., type and severity), and medical images (e.g., specific equipment, imaging protocol, patient positioning) used during training [<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/article/10.1007/s00134-020-06316-8#ref-CR7">7</a>]. When evaluating an ML system, it is critical to understand the composition of the imaging studies used for training and whether it approximates those at your institution. Models trained on larger and more generalized datasets reduce the risks from bias but cannot entirely eliminate it.</p>
<h3 id="Model-fragility-ensure-the-vendor-provides-the-parameters-within-which-their-model-should-operate-safely"><a href="#Model-fragility-ensure-the-vendor-provides-the-parameters-within-which-their-model-should-operate-safely" class="headerlink" title="Model fragility: ensure the vendor provides the parameters within which their model should operate safely."></a>Model fragility: ensure the vendor provides the parameters within which their model should operate safely.</h3><p>The behavior of an ML system outside the scope of training data can be unpredictable and potentially unsafe [<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/article/10.1007/s00134-020-06316-8#ref-CR8">8</a>]. For example, ML models may fail to detect obvious pathology if the imaging study presented is dissimilar to training data [<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/article/10.1007/s00134-020-06316-8#ref-CR9">9</a>]. More disturbing is that ML models may fail to recognize that they are operating beyond their “comfort zone” and produce incorrect outputs with high confidence [<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/article/10.1007/s00134-020-06316-8#ref-CR10">10</a>]. Also, ML systems are often trained to distill complex imaging data down to simple binary results: is the pathology present or not? This loss of granularity can result in cases close to the decision boundary being marked as normal even when clinically relevant findings may be present. When considering the implementation of an ML system, it is important to know the parameters within which the model should operate safely, if the model provides a measure of prediction confidence, and how the model will respond to the incomplete or poor-quality imaging studies that are often encountered in the real world.</p>
<h3 id="Error-prone-behavior-ensure-the-clinical-team-does-not-develop-overdependence-on-the-ML-technology-and-loses-sight-of-its-fallibilities"><a href="#Error-prone-behavior-ensure-the-clinical-team-does-not-develop-overdependence-on-the-ML-technology-and-loses-sight-of-its-fallibilities" class="headerlink" title="Error-prone behavior: ensure the clinical team does not develop overdependence on the ML technology and loses sight of its fallibilities"></a>Error-prone behavior: ensure the clinical team does not develop overdependence on the ML technology and loses sight of its fallibilities</h3><p>Computer aids and automation are employed to improve efficiency and reduce error. However, they may actually lead to new and different types of errors [<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/article/10.1007/s00134-020-06316-8#ref-CR11">11</a>]. Individuals may hold beliefs about the superiority of computer systems over human experts [<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/article/10.1007/s00134-020-06316-8#ref-CR12">12</a>] and a consistently reliable system may even appear infallible. Blind trust in computer aids may impair an individual’s ability to recognize incorrect computer advice which may ultimately result in decision errors [<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/article/10.1007/s00134-020-06316-8#ref-CR11">11</a>]. Furthermore, there is a risk of over-reliance on computer aids particularly in a clinical setting when many concurrent tasks compete for an individual’s time and attention [<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/article/10.1007/s00134-020-06316-8#ref-CR13">13</a>]. Critical care physicians must be aware that ML models are imperfect and can be used in biased ways; so, human judgment will be necessary in determining how much weight should be given to them in the clinical decision-making process.</p>
<h2 id="Revisiting-the-clinical-scenario"><a href="#Revisiting-the-clinical-scenario" class="headerlink" title="Revisiting the clinical scenario"></a>Revisiting the clinical scenario</h2><p>Having improved your understanding of AI systems, you realize the usefulness of the proposed system may be overstated. Similar to many current commercial systems targeting medical imaging, the start-up is marketing the product for widespread use but has not validated it on external data or in a full clinical setting [<a target="_blank" rel="noopener" href="http://61.175.198.136:8083/article/10.1007/s00134-020-06316-8#ref-CR14">14</a>]. Worse, its small training set consists mostly of PA radiographs of non-ICU patients which are notably different from your typical patients. Keenly aware that the value of the system is solely how it behaves in your institution, you insist on more thorough evaluation of the product with local imaging cases prior to further consideration.</p>
<h3 id="Key-points-for-the-intelligent-use-of-AI-in-medical-imaging"><a href="#Key-points-for-the-intelligent-use-of-AI-in-medical-imaging" class="headerlink" title="Key points for the intelligent use of AI in medical imaging"></a>Key points for the intelligent use of AI in medical imaging</h3><table>
<thead>
<tr>
<th>To effectively evaluate a machine learning (ML) system, you should understand how they are created and the common methods used to assess them.</th>
</tr>
</thead>
<tbody><tr>
<td>Proper evaluation of an ML system requires you to consider more than the tool’s accuracy or ROC curve.</td>
</tr>
<tr>
<td>ML systems can be biased in a variety of ways and one that works well in one clinical environment may perform very poorly in another.</td>
</tr>
<tr>
<td>It is common for ML systems to behave unpredictably and potentially dangerously outside the scope of their training data.</td>
</tr>
<tr>
<td>Using an ML system can introduce new types of errors into the clinical decision process.</td>
</tr>
</tbody></table>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css"> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://humorlife.github.io/2021/02/21/AI%E5%9C%A8%E5%8C%BB%E5%AD%A6%E5%BD%B1%E5%83%8F%E5%BA%94%E7%94%A8%E7%9A%845%E4%B8%AA%E5%8E%9F%E5%88%99/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2021/02/21/%E9%87%8D%E7%97%87AI%E5%85%B3%E4%B9%8E%E4%BC%A6%E7%90%86%E7%9A%845%E4%BB%B6%E4%BA%8B/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            重症AI关乎伦理的5件事
          
        </div>
      </a>
    
    
      <a href="/2021/02/21/%E5%8F%AF%E9%80%8F%E8%BF%87%E8%A1%80%E8%84%91%E5%B1%8F%E9%9A%9C%E7%9A%84%E6%8A%97%E8%8F%8C%E8%8D%AF%E7%89%A9/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">可透过血脑屏障的抗菌药物</div>
      </a>
    
  </nav>

   
<!-- valine评论 -->
<div id="vcomments-box">
  <div id="vcomments"></div>
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script>
<script>
  new Valine({
    el: "#vcomments",
    app_id: "ydIIgMt7XyFrrYu99oRl6Wj6-gzGzoHsz",
    app_key: "LcqDaexYhippql42xM3cDT65",
    path: window.location.pathname,
    avatar: "monsterid",
    placeholder: "给我的文章加点评论吧~",
    recordIP: true,
  });
  const infoEle = document.querySelector("#vcomments .info");
  if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
    infoEle.childNodes.forEach(function (item) {
      item.parentNode.removeChild(item);
    });
  }
</script>
<style>
  #vcomments-box {
    padding: 5px 30px;
  }

  @media screen and (max-width: 800px) {
    #vcomments-box {
      padding: 5px 0px;
    }
  }

  #vcomments-box #vcomments {
    background-color: #fff;
  }

  .v .vlist .vcard .vh {
    padding-right: 20px;
  }

  .v .vlist .vcard {
    padding-left: 10px;
  }
</style>

 
   
     
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2021
        <i class="ri-heart-fill heart_icon"></i> SeasideCCM
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></s>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="海滨重症"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i></p>
  <div class="reward-box">
    
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->


<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: 'main',
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto'
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>

<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->


<script src="/js/busuanzi-2.3.pure.min.js"></script>


<!-- ClickLove -->

<!-- ClickBoom1 -->

<script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script>

<script src="/js/clickBoom1.js"></script>


<!-- ClickBoom2 -->

<!-- CodeCopy -->


<link rel="stylesheet" href="/css/clipboard.css">

<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>


<!-- CanvasBackground -->


<script src="/js/dz.js"></script>



    
    <div id="music">
    
    
    
    <iframe frameborder="no" border="1" marginwidth="0" marginheight="0" width="200" height="52"
        src="//music.163.com/outchain/player?type=2&id=1324720213&auto=1&height=32"></iframe>
</div>

<style>
    #music {
        position: fixed;
        right: 15px;
        bottom: 0;
        z-index: 998;
    }
</style>
    
  </div>
</body>

</html>